# ~/cal.defintek.io.conf
#
# This is the Apache configuration for your Cal.defintek.io subdomain.
#
# How to use:
# 1. Copy this file to /etc/apache2/sites-available/
#    sudo cp ~/cal.defintek.io.conf /etc/apache2/sites-available/cal.defintek.io.conf
#
# 2. Enable the site:
#    sudo a2ensite cal.defintek.io
#
# 3. Reload Apache:
#    sudo systemctl reload apache2
#
# You will also need to ensure you have a valid SSL certificate for cal.defintek.io.
# You can get one for free using Let's Encrypt's certbot.

<VirtualHost *:443>
    ServerName cal.defintek.io

    # --- SSL CONFIGURATION ---
    # Update this with the correct path to your SSL certificate files.
    # If you use Let's Encrypt, the paths will look like this:
    SSLEngine on
    SSLCertificateFile /etc/letsencrypt/live/cal.defintek.io/fullchain.pem
    SSLCertificateKeyFile /etc/letsencrypt/live/cal.defintek.io/privkey.pem

    # --- PROXY SETTINGS ---
    ProxyPreserveHost On
    ProxyRequests Off
    
    # Proxy for HTTP traffic
    ProxyPass / http://127.0.0.1:5000/
    ProxyPassReverse / http://127.0.0.1:5000/

    # Proxy for WebSocket (for real-time features)
    RewriteEngine On
    RewriteCond %{HTTP:Upgrade} =websocket [NC]
    RewriteRule /(.*) ws://127.0.0.1:5000/$1 [P,L]

    # --- LOGS ---
    ErrorLog ${APACHE_LOG_DIR}/cal.defintek.io-error.log
    CustomLog ${APACHE_LOG_DIR}/cal.defintek.io-access.log combined
</VirtualHost> 